<div class="dashboard-container">
  <app-page-header
    title="Dashboard Clienti"
    subtitle="Gestione anagrafica e monitoraggio revenue"
  ></app-page-header>

  <main class="content-area">
    <div style="margin-bottom: 20px">
      <p-button
        label="Aggiungi Cliente"
        icon="pi pi-plus"
        (onClick)="openModal()"
      ></p-button>
    </div>

    @if (customers(); as customers) {
    <div class="card bg-white rounded-2xl shadow-lg overflow-hidden">
      <p-table
        [value]="customers"
        [tableStyle]="{ 'min-width': '50rem' }"
        [stripedRows]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>Nome</th>
            <th>Azienda / Settore</th>
            <th>Stato</th>
            <th>Piano</th>
            <th>Fatturato</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-customer>
          <tr>
            <td>
              <div class="flex flex-col">
                <strong
                  class="cursor-pointer text-primary hover:text-primary-600 underline"
                  [routerLink]="['/customers', customer.id]"
                  >{{ customer.name }}</strong
                >
                <small class="text-500">{{ customer.email }}</small>
              </div>
            </td>

            <td>
              <div class="flex flex-col">
                {{ customer.company }}
                <small class="text-500">{{ customer.industry }}</small>
              </div>
            </td>

            <td>
              <app-status-tag [value]="customer.status"></app-status-tag>
            </td>
            <td>
              <span class="text-sm font-semibold text-gray-700">{{
                customer.plan || "N/A"
              }}</span>
            </td>
            <td class="font-bold">
              {{ customer.revenue | currency : "EUR" }}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5">
              <app-empty-state
                title="Nessun cliente presente"
                subtitle="Aggiungi il tuo primo cliente per iniziare."
                icon="pi pi-users"
              ></app-empty-state>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    } @else {
    <app-loading-state
      message="Caricamento dati aziendali..."
    ></app-loading-state>
    }
    <app-customer-modal
      [isOpen]="isModalOpen"
      (close)="closeModal()"
      (save)="saveCustomer($event)"
    ></app-customer-modal>
  </main>
</div>
