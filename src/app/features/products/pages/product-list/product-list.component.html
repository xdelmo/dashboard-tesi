<div class="dashboard-container">
  <app-page-header
    title="Prodotti & Servizi"
    subtitle="Gestisci il catalogo dei servizi offerti"
  ></app-page-header>

  <main class="content-area">
    <div style="margin-bottom: 20px">
      <p-button
        label="Aggiungi Prodotto"
        icon="pi pi-plus"
        (onClick)="openModal()"
      ></p-button>
    </div>
    @if (products(); as productsList) {
    <div class="card bg-white rounded-2xl shadow-lg overflow-hidden">
      <p-table
        [value]="productsList"
        [tableStyle]="{ 'min-width': '50rem' }"
        [stripedRows]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th style="width: 40%">Prodotto</th>
            <th style="width: 15%">Categoria</th>
            <th style="width: 15%">Prezzo</th>
            <th style="width: 15%">Durata</th>
            <th style="width: 15%">Stato</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
          <tr>
            <td>
              <strong
                class="cursor-pointer text-primary hover:text-primary-600 underline"
                [routerLink]="['/products', product.id]"
              >
                {{ product.name }}
              </strong>
              <div class="text-xs text-gray-500">{{ product.description }}</div>
            </td>
            <td>
              <p-tag
                [value]="product.category"
                severity="info"
                [rounded]="true"
              ></p-tag>
            </td>
            <td class="font-bold">
              {{ product.price | currency : "EUR" : "symbol" : "1.0-0" }}
            </td>
            <td class="text-gray-600">
              {{ product.duration }}
            </td>
            <td>
              <app-status-tag [value]="product.status"></app-status-tag>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5">
              <app-empty-state
                title="Nessun prodotto disponibile"
                subtitle="Aggiungi nuovi prodotti per popolare il catalogo."
                icon="pi pi-box"
              ></app-empty-state>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    } @else {
    <app-loading-state message="Caricamento prodotti..."></app-loading-state>
    }

    <app-product-modal
      [isOpen]="isModalOpen"
      (close)="closeModal()"
      (save)="saveProduct($event)"
    ></app-product-modal>
  </main>
</div>
